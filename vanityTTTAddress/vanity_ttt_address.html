<!DOCTYPE html>
<html>
<script src="core.js">

</script>

<body>

<h2>Vanity TTT Address Hunter</h2>

<script>

    var WALLET_SEARCH_SCOPE = 8
    var WALLET_ADDRESS_SEARCH_SCOPE = 40
    var MNEMONIC_SEARCH_SCOPE = 100

    async function generateMnemonicAndAddress() {
        for(var i = 0; i < MNEMONIC_SEARCH_SCOPE; i++) {
            var mnemonic = Client.mnemonic();
            var privkey = Client.xPrivKey(mnemonic);
            for(walletIndex = 0; walletIndex < WALLET_SEARCH_SCOPE; walletIndex++) {
                var walletPubkey = Client.walletPubKey(privkey, walletIndex)
                checkAddressByWalletPubkey(mnemonic, walletIndex, walletPubkey)
            }
            updateProgress(i+1, MNEMONIC_SEARCH_SCOPE)

            await sleep(3000);

        }
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    function checkAddressByWalletPubkey(mnemonic, walletIndex, walletPubkey) {

        for(var i = 0; i < WALLET_ADDRESS_SEARCH_SCOPE; i++) {
            var address = Client.walletAddress(walletPubkey, 0, i)
            if (isVanityAddress(address)) {
                showVanityAddress(mnemonic, walletIndex, i, address)
            }
        }
    }

    function isVanityAddress(address) {
        //TODO: regular expression.
        return address.startsWith('TT')
            || address.startsWith('GUO')
            || address.startsWith('MN')
            || address.startsWith('MY')
            || address.startsWith('QQ')
            || address.startsWith('BTC')
            || address.startsWith('ETH')
            || address.startsWith('EOS')
            || address.startsWith('IOT')
            || address.startsWith('DROID')
            || address.startsWith('ANDROID')

    }

    function showVanityAddress(mnemonic, walletIndex, addressIndex, address) {

        appendResultList(address + "@" + mnemonic + ":::" + walletIndex + ":::" + addressIndex)

    }

    function appendResultList(resultItem) {

          var ul = document.getElementById("result_list");
          var li = document.createElement("li");
          li.appendChild(document.createTextNode(resultItem));
          ul.appendChild(li);

    }

    function updateProgress(i, totalMnemonic) {
        document.getElementById('progress_percent').innerHTML = "Steps:" + i + "  /Total:" + totalMnemonic
    }

</script>

<button type="button"
        onclick="generateMnemonicAndAddress()">Let's Go
</button>
<p id="progress_percent">progress_percent</p>
<ul id="result_list">
</ul>

</body>

</html>
